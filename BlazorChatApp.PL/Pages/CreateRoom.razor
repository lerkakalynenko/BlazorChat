@page "/createRoom"
@using BlazorChatApp.BLL.Infrastructure.Interfaces
@using BlazorChatApp.BLL.Responses
@using Blazored.LocalStorage
@inject IRequestService RequestService
@inject NavigationManager NavManager
@inject ILocalStorageService StorageService
@inherits BaseComponent
<h1>Creating new chat</h1>

<div class="container">
    <p>@notification</p>
    <input @bind:event="oninput" @bind="chatName"/>
    <br />
    <button class="btn btn-primary" type="submit" @onclick="CreateChat" >
        Create new room
    </button>
    </div>
@code
{
    private string chatName;
    private string notification = "";
    private async void CreateChat()
    {
        try
        {
            CreateChatResponse roomIsCreated = await RequestService.CreateRoomAsync(chatName);
            CheckIfUserHasAccess(roomIsCreated, async () => NavManager.NavigateTo("/MyChats"));
        }
        catch
        {
            notification = $"Failed to create room {chatName}!";
        }
    }
}
